<style type="text/css">
.selectBox {
    bottom: 70px;
    cursor: pointer;
    position: absolute;
    left: 50%;
    width: 250px;
    z-index: 10;
    margin-left: -125px;
}
.selectBox__desk-options li {
    text-align: center;
}

.selectBox__desk-options li:first-child {
    display: none;
}

@media (max-width: 768px) {
  .selectBox {
     margin-left: 0;
  }
  .selectBox__native {
    font-size: 16px;
  }
}
</style>

<div class="newHomepage__section">
    <div class="hpFullWidthBannerForDropdown">
        <div class="hpFullWidthBannerForDropdown__contentWrapper">
            <div class="hpFullWidthBannerForDropdown__titleWrapper">
                <picture class="hpFullWidthBannerForDropdown__imageWrapper">
                    <source srcset="https://navabi.imgix.net/img/index/2018/05/clearance_en-d.jpg?w=1170&fit=clip&q=75, https://navabi.imgix.net/img/index/2018/05/clearance_en-d.jpg?w=2340&fit=clip&q=75 2x" media="(min-width: 991px)">
                    <source srcset="https://navabi.imgix.net/img/index/2018/05/clearance_en-d.jpg?w=768&fit=clip&q=75, https://navabi.imgix.net/img/index/2018/05/clearance_en-d.jpg?w=1536&fit=clip&q=75 2x" media="(min-width: 769px)">
                    <source srcset="https://navabi.imgix.net/img/index/2018/05/clearance_en-m.jpg?w=768&fit=clip&q=75, https://navabi.imgix.net/img/index/2018/05/clearance_en-m.jpg?w=1536&fit=clip&q=75 2x" media="(min-width: 0px)">
                    <img class="hpFullWidthBanner__image" srcset="https://navabi.imgix.net/img/index/2018/05/clearance_en-d.jpg?w=768&fit=clip&q=75" alt="">
                </picture>
            </div>
        </div>
        <div class="selectBox" data-js-selectbox>
            <ul class="selectBox__desk-options"></ul>
            <div class="selectBox__label" id="selectBox__label" data-tracking='2018_sale_banner_with_dropdown_cta' data-href="/ofertas.html">
                <b>Shop clearance ></b>
            </div>
            <select id="selectBox__native" class="selectBox__native" onchange="oldGAlinkTracking($(this).val(), $(this).find('option:selected').data('tracking'))">
                <option>Escoge una opci√≥n</option>
                <option value="/ofertas.html" data-tracking='2018_sale_banner_with_dropdown_mobile_sale'>Shop clearance ></option>
                <option value="/topic/hasta-60-porciento/" data-tracking='2018_sale_banner_with_dropdown_a'>
                    Up to 60% off >
                </option>
                <option value="/topic/hasta-50-porciento/" data-tracking='2018_sale_banner_with_dropdown_b'>
                    Up to 50% off >
                </option>
                <option value="/topic/hasta-40-porciento/" data-tracking='2018_sale_banner_with_dropdown_c'>
                    Up to 40% off >
                </option>
            </select>
        </div>
    </div>
</div>

<script>
$('[data-js-selectbox]').each(function () {
    var thatParent = $(this);
    thatParent.find('select option:not(:first)').each(function () {
        var that = $(this);
        var thatHref = $(this).val();
        var thatTracking = $(this).attr('data-tracking');
        
        thatParent.find('.selectBox__desk-options').append("<li><a href='" + thatHref + "' data-tracking='" + thatTracking + "'>" + that.text() + "</a></li>");
    });
});

if (!$('html').hasClass('dev-smartphone')) {
    $('[data-js-selectbox]')
    .on('mouseenter', function () {
        if ($('.selectBox__desk-options').is(':not(:animated)')) {
            $(this).find('.selectBox__desk-options').slideDown(250);
        }
    })
    .on('mouseleave', function () {
        if ($('.selectBox__desk-options').is(':not(:animated)')) {
            $(this).find('.selectBox__desk-options').slideUp(250);
        }
    });
}

var buttonHref = document.getElementById('selectBox__label');
buttonHrefLocation = buttonHref.dataset.href;

buttonHref.addEventListener('click', function(event){
    window.location = buttonHrefLocation;
});

var selectEl = document.getElementById('selectBox__native');

selectEl.onchange = function(){
    window.location = this.value;
};
</script>
